<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Premium Admin Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <style>
        /* Previous CSS remains exactly the same, only adding new styles for login */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Noto Sans Bengali', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            min-height: 100vh;
            color: #fff;
        }
        
        /* Password Login Modal */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .login-container {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 15px;
            padding: 40px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            border: 3px solid #ff9800;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .login-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .login-logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff9800, #ff5722, #00bcd4);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3);
        }
        
        .login-logo-icon i {
            font-size: 2.2rem;
            color: white;
        }
        
        .login-logo-text {
            display: flex;
            flex-direction: column;
            line-height: 1;
        }
        
        .login-logo-main {
            font-size: 2rem;
            font-weight: 800;
            color: #ff9800;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .login-logo-sub {
            font-size: 1rem;
            font-weight: 600;
            color: #00bcd4;
            letter-spacing: 0.5px;
            margin-top: 2px;
        }
        
        .login-title {
            font-size: 1.5rem;
            color: #fff;
            margin-bottom: 10px;
        }
        
        .login-subtitle {
            color: #b0bec5;
            font-size: 0.9rem;
            margin-bottom: 30px;
        }
        
        .login-input-group {
            margin-bottom: 25px;
            text-align: left;
        }
        
        .login-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #fff;
            font-size: 0.95rem;
        }
        
        .login-input {
            width: 100%;
            padding: 14px;
            border: 2px solid rgba(255, 152, 0, 0.5);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s;
        }
        
        .login-input:focus {
            border-color: #ff5722;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 10px rgba(255, 87, 34, 0.3);
        }
        
        .login-btn {
            background: linear-gradient(45deg, #ff9800, #ff5722);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        .login-btn:hover {
            background: linear-gradient(45deg, #ff5722, #ff9800);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 87, 34, 0.3);
        }
        
        .login-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .error-message {
            color: #ff5722;
            font-size: 0.9rem;
            margin-top: 10px;
            text-align: center;
            min-height: 20px;
        }
        
        /* Admin Header (shown after login) */
        .admin-header {
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #ff9800;
            display: none;
        }
        
        .admin-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .admin-logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff9800, #ff5722, #00bcd4);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.3);
        }
        
        .admin-logo-icon i {
            font-size: 2.2rem;
            color: white;
        }
        
        .admin-logo-text {
            display: flex;
            flex-direction: column;
            line-height: 1;
        }
        
        .admin-logo-main {
            font-size: 2rem;
            font-weight: 800;
            color: #ff9800;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .admin-logo-sub {
            font-size: 1rem;
            font-weight: 600;
            color: #00bcd4;
            letter-spacing: 0.5px;
            margin-top: 2px;
        }
        
        .admin-title {
            font-size: 1.5rem;
            color: #fff;
            margin-bottom: 10px;
        }
        
        .admin-subtitle {
            color: #b0bec5;
            font-size: 0.9rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .admin-controls {
            margin-top: 20px;
        }
        
        .logout-btn {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .logout-btn:hover {
            background: linear-gradient(45deg, #c82333, #dc3545);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }
        
        /* Main Container */
        .admin-container {
            display: flex;
            flex-wrap: wrap;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            gap: 20px;
            display: none;
        }
        
        /* Left Side - Form */
        .admin-form-section {
            flex: 1;
            min-width: 300px;
            background: rgba(26, 26, 46, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #ff9800;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        /* Right Side - Platforms List */
        .admin-list-section {
            flex: 2;
            min-width: 300px;
            background: rgba(26, 26, 46, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #00bcd4;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .section-title {
            font-size: 1.3rem;
            color: #ff9800;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 152, 0, 0.3);
        }
        
        .list-section-title {
            color: #00bcd4;
            border-bottom: 2px solid rgba(0, 188, 212, 0.3);
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #fff;
            font-size: 0.95rem;
        }
        
        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(255, 152, 0, 0.5);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s;
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-input:focus, .form-textarea:focus, .form-select:focus {
            border-color: #ff5722;
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 10px rgba(255, 87, 34, 0.3);
        }
        
        /* Icon Selection Grid */
        .icon-selection {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .icon-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .icon-option:hover {
            background: rgba(255, 152, 0, 0.1);
            border-color: #ff9800;
            transform: translateY(-2px);
        }
        
        .icon-option.selected {
            background: rgba(255, 152, 0, 0.2);
            border-color: #ff9800;
            box-shadow: 0 0 10px rgba(255, 152, 0, 0.3);
        }
        
        .icon-option i {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .icon-option-name {
            font-size: 0.7rem;
            text-align: center;
            color: #b0bec5;
        }
        
        /* Features Input */
        .features-container {
            margin-top: 10px;
        }
        
        .feature-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .feature-input {
            flex: 1;
        }
        
        .add-feature-btn, .remove-feature-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .add-feature-btn {
            background: linear-gradient(45deg, #00bcd4, #0097a7);
            color: white;
        }
        
        .add-feature-btn:hover {
            background: linear-gradient(45deg, #0097a7, #00bcd4);
        }
        
        .remove-feature-btn {
            background: linear-gradient(45deg, #ff5722, #d84315);
            color: white;
        }
        
        .remove-feature-btn:hover {
            background: linear-gradient(45deg, #d84315, #ff5722);
        }
        
        /* Form Buttons */
        .form-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
            flex: 1;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #ff9800, #ff5722);
            color: white;
        }
        
        .btn-primary:hover {
            background: linear-gradient(45deg, #ff5722, #ff9800);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 87, 34, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #00bcd4, #0097a7);
            color: white;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(45deg, #0097a7, #00bcd4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 188, 212, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
        }
        
        .btn-danger:hover {
            background: linear-gradient(45deg, #c82333, #dc3545);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }
        
        /* Platforms List */
        .platforms-list {
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .platforms-list::-webkit-scrollbar {
            width: 8px;
        }
        
        .platforms-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .platforms-list::-webkit-scrollbar-thumb {
            background: rgba(255, 152, 0, 0.5);
            border-radius: 10px;
        }
        
        .platforms-list::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 152, 0, 0.7);
        }
        
        /* Platform Item */
        .platform-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #ff9800;
            transition: all 0.3s;
        }
        
        .platform-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .platform-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .platform-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .platform-icon-display {
            font-size: 1.8rem;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .platform-details {
            flex: 1;
        }
        
        .platform-name-display {
            font-size: 1.2rem;
            font-weight: 700;
            color: #ff9800;
            margin-bottom: 5px;
        }
        
        .platform-price-display {
            color: #00bcd4;
            font-weight: 600;
            font-size: 1rem;
        }
        
        .platform-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.8rem;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .edit-btn {
            background: rgba(255, 152, 0, 0.2);
            color: #ff9800;
            border: 1px solid rgba(255, 152, 0, 0.5);
        }
        
        .edit-btn:hover {
            background: rgba(255, 152, 0, 0.3);
        }
        
        .delete-btn {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid rgba(220, 53, 69, 0.5);
        }
        
        .delete-btn:hover {
            background: rgba(220, 53, 69, 0.3);
        }
        
        .platform-description-display {
            color: #ddd;
            font-size: 0.9rem;
            margin-bottom: 10px;
            line-height: 1.4;
        }
        
        .platform-features-display {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .feature-tag {
            background: rgba(0, 188, 212, 0.2);
            color: #00bcd4;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .feature-tag i {
            font-size: 0.7rem;
        }
        
        /* Status Badge */
        .status-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-active {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
        }
        
        .status-inactive {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #b0bec5;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #ff9800;
            opacity: 0.5;
        }
        
        /* Loading Spinner */
        .loading-spinner {
            text-align: center;
            padding: 30px;
        }
        
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #ff9800;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Platform Specific Colors */
        .youtube { color: #FF0000; }
        .facebook { color: #1877F2; }
        .instagram { color: #E4405F; }
        .tiktok { color: #000000; }
        .whatsapp { color: #25D366; }
        .telegram { color: #0088cc; }
        .freefire { color: #FF8800; }
        .netflix { color: #E50914; }
        .spotify { color: #1DB954; }
        .pubg { color: #F9A602; }
        .default { color: #ff9800; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .admin-container {
                flex-direction: column;
                padding: 15px;
            }
            
            .admin-form-section, .admin-list-section {
                width: 100%;
            }
            
            .icon-selection {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .platform-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .platform-actions {
                align-self: flex-end;
            }
            
            .form-buttons {
                flex-direction: column;
            }
            
            .admin-logo {
                gap: 10px;
            }
            
            .admin-logo-icon {
                width: 50px;
                height: 50px;
            }
            
            .admin-logo-icon i {
                font-size: 1.8rem;
            }
            
            .admin-logo-main {
                font-size: 1.6rem;
            }
            
            .admin-logo-sub {
                font-size: 0.9rem;
            }
            
            .admin-title {
                font-size: 1.3rem;
            }
            
            .login-container {
                padding: 30px 20px;
            }
        }
        
        @media (max-width: 480px) {
            .icon-selection {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .feature-input-group {
                flex-direction: column;
            }
            
            .admin-logo-main {
                font-size: 1.4rem;
            }
            
            .admin-title {
                font-size: 1.2rem;
            }
            
            .platform-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .platform-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .action-btn {
                flex: 1;
                text-align: center;
            }
            
            .login-logo-main {
                font-size: 1.4rem;
            }
        }
    </style>
</head>
<body>
    <!-- Password Login Modal -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-container">
            <div class="login-logo">
                <div class="login-logo-icon">
                    <i class="fas fa-crown"></i>
                </div>
                <div class="login-logo-text">
                    <div class="login-logo-main">EASY PREMIUM</div>
                    <div class="login-logo-sub">Admin Panel</div>
                </div>
            </div>
            <h2 class="login-title">এডমিন লগইন</h2>
            <p class="login-subtitle">পাসওয়ার্ড দিন এডমিন প্যানেল অ্যাক্সেস করার জন্য</p>
            
            <form id="loginForm">
                <div class="login-input-group">
                    <label for="adminPassword" class="login-label">এডমিন পাসওয়ার্ড</label>
                    <input type="password" id="adminPassword" class="login-input" placeholder="পাসওয়ার্ড দিন..." required>
                </div>
                
                <button type="submit" id="loginBtn" class="login-btn">
                    লগইন করুন
                </button>
                
                <div id="loginError" class="error-message"></div>
            </form>
        </div>
    </div>
    
    <!-- Admin Panel (shown after login) -->
    <header class="admin-header" id="adminHeader">
        <div class="admin-logo">
            <div class="admin-logo-icon">
                <i class="fas fa-crown"></i>
            </div>
            <div class="admin-logo-text">
                <div class="admin-logo-main">EASY PREMIUM</div>
                <div class="admin-logo-sub">Admin Panel</div>
            </div>
        </div>
        <h1 class="admin-title">প্ল্যাটফর্ম ম্যানেজমেন্ট</h1>
        <p class="admin-subtitle">এখানে আপনি নতুন প্ল্যাটফর্ম যোগ করতে পারেন, বিদ্যমান প্ল্যাটফর্ম এডিট করতে পারেন এবং ডিলিট করতে পারেন।</p>
        
        <div class="admin-controls">
            <button id="logoutBtn" class="logout-btn">লগ আউট</button>
        </div>
    </header>

    <!-- Main Container -->
    <div class="admin-container" id="adminContainer">
        <!-- Left Side - Form -->
        <section class="admin-form-section">
            <h2 class="section-title" id="formTitle">নতুন প্ল্যাটফর্ম যোগ করুন</h2>
            
            <form id="platformForm">
                <input type="hidden" id="platformId" value="">
                
                <div class="form-group">
                    <label for="platformName" class="form-label">প্ল্যাটফর্মের নাম *</label>
                    <input type="text" id="platformName" class="form-input" placeholder="যেমন: YouTube Premium" required>
                </div>
                
                <div class="form-group">
                    <label for="platformIcon" class="form-label">প্ল্যাটফর্ম আইকন সিলেক্ট করুন *</label>
                    <select id="platformIcon" class="form-select" required>
                        <option value="">একটি আইকন সিলেক্ট করুন</option>
                        <option value="youtube">YouTube</option>
                        <option value="facebook">Facebook</option>
                        <option value="instagram">Instagram</option>
                        <option value="tiktok">TikTok</option>
                        <option value="whatsapp">WhatsApp</option>
                        <option value="telegram">Telegram</option>
                        <option value="freefire">FreeFire</option>
                        <option value="netflix">Netflix</option>
                        <option value="spotify">Spotify</option>
                        <option value="pubg">PUBG</option>
                        <option value="default">অন্যান্য</option>
                    </select>
                    
                    <div class="icon-selection" id="iconSelection">
                        <!-- Icons will be populated by JavaScript -->
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="platformDescription" class="form-label">বর্ণনা *</label>
                    <textarea id="platformDescription" class="form-textarea" placeholder="প্ল্যাটফর্মের সংক্ষিপ্ত বর্ণনা লিখুন..." required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="platformPrice" class="form-label">দাম *</label>
                    <input type="text" id="platformPrice" class="form-input" placeholder="যেমন: ৳ 299 / মাস" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ফিচারগুলো যোগ করুন</label>
                    <div class="features-container" id="featuresContainer">
                        <!-- Features will be added here dynamically -->
                    </div>
                    <button type="button" id="addFeatureBtn" class="add-feature-btn">নতুন ফিচার যোগ করুন</button>
                </div>
                
                <div class="form-group">
                    <label for="platformCategory" class="form-label">ক্যাটাগরি</label>
                    <input type="text" id="platformCategory" class="form-input" placeholder="যেমন: Social Media, Gaming, Streaming">
                </div>
                
                <div class="form-group">
                    <label for="platformOrder" class="form-label">অর্ডার নম্বর</label>
                    <input type="number" id="platformOrder" class="form-input" placeholder="ছোট সংখ্যা আগে দেখাবে" value="0">
                    <small style="color: #b0bec5; font-size: 0.8rem;">ছোট সংখ্যা আগে দেখাবে (ডিফল্ট: 0)</small>
                </div>
                
                <div class="form-group">
                    <label for="platformStatus" class="form-label">স্ট্যাটাস</label>
                    <select id="platformStatus" class="form-select">
                        <option value="active">সক্রিয়</option>
                        <option value="inactive">নিষ্ক্রিয়</option>
                    </select>
                </div>
                
                <div class="form-buttons">
                    <button type="submit" id="submitBtn" class="btn btn-primary">সেভ করুন</button>
                    <button type="button" id="resetBtn" class="btn btn-secondary">রিসেট করুন</button>
                    <button type="button" id="cancelEditBtn" class="btn btn-danger" style="display: none;">এডিট বাতিল করুন</button>
                </div>
            </form>
        </section>
        
        <!-- Right Side - Platforms List -->
        <section class="admin-list-section">
            <h2 class="section-title list-section-title">প্ল্যাটফর্ম তালিকা</h2>
            <div id="platformsList" class="platforms-list">
                <div class="loading-spinner">
                    <div class="spinner"></div>
                    <p>প্ল্যাটফর্ম লোড হচ্ছে...</p>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Firebase Configuration - আপনার Original Key ব্যবহার করুন
        const firebaseConfig = {
            apiKey: "AIzaSyBt9t6mcjUtXxX2igAJdseuIIc8pP_QPEw",
            authDomain: "easy-premium.firebaseapp.com",
            databaseURL: "https://easy-premium-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "easy-premium",
            storageBucket: "easy-premium.firebasestorage.app",
            messagingSenderId: "155891252265",
            appId: "1:155891252265:web:77ab41de24231e8e5ef038",
            measurementId: "G-CHL8K8HRPX"
        };

        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.log("Firebase already initialized");
        }
        
        const database = firebase.database();
        const auth = firebase.auth();
        
        // DOM Elements
        const loginOverlay = document.getElementById('loginOverlay');
        const loginForm = document.getElementById('loginForm');
        const adminPassword = document.getElementById('adminPassword');
        const loginBtn = document.getElementById('loginBtn');
        const loginError = document.getElementById('loginError');
        
        const adminHeader = document.getElementById('adminHeader');
        const adminContainer = document.getElementById('adminContainer');
        const logoutBtn = document.getElementById('logoutBtn');
        
        const platformForm = document.getElementById('platformForm');
        const platformId = document.getElementById('platformId');
        const platformName = document.getElementById('platformName');
        const platformIcon = document.getElementById('platformIcon');
        const platformDescription = document.getElementById('platformDescription');
        const platformPrice = document.getElementById('platformPrice');
        const platformCategory = document.getElementById('platformCategory');
        const platformOrder = document.getElementById('platformOrder');
        const platformStatus = document.getElementById('platformStatus');
        const iconSelection = document.getElementById('iconSelection');
        const featuresContainer = document.getElementById('featuresContainer');
        const addFeatureBtn = document.getElementById('addFeatureBtn');
        const submitBtn = document.getElementById('submitBtn');
        const resetBtn = document.getElementById('resetBtn');
        const cancelEditBtn = document.getElementById('cancelEditBtn');
        const formTitle = document.getElementById('formTitle');
        const platformsList = document.getElementById('platformsList');
        
        // Variables
        let platforms = [];
        let selectedIcon = '';
        let isEditing = false;
        let currentEditId = null;
        let isAdminLoggedIn = false;
        
        // Available icons with names
        const availableIcons = [
            { value: 'youtube', name: 'YouTube', class: 'fab fa-youtube youtube' },
            { value: 'facebook', name: 'Facebook', class: 'fab fa-facebook-f facebook' },
            { value: 'instagram', name: 'Instagram', class: 'fab fa-instagram instagram' },
            { value: 'tiktok', name: 'TikTok', class: 'fab fa-tiktok tiktok' },
            { value: 'whatsapp', name: 'WhatsApp', class: 'fab fa-whatsapp whatsapp' },
            { value: 'telegram', name: 'Telegram', class: 'fab fa-telegram telegram' },
            { value: 'freefire', name: 'FreeFire', class: 'fas fa-fire freefire' },
            { value: 'netflix', name: 'Netflix', class: 'fab fa-netflix netflix' },
            { value: 'spotify', name: 'Spotify', class: 'fab fa-spotify spotify' },
            { value: 'pubg', name: 'PUBG', class: 'fas fa-gamepad pubg' },
            { value: 'default', name: 'অন্যান্য', class: 'fas fa-cube default' }
        ];
        
        // Admin password (you can change this)
        // In production, you should store this in Firebase Database and fetch it securely
        const ADMIN_PASSWORD = "easyadmin123"; // আপনি এটা পরিবর্তন করুন
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            
            // Login form submission
            loginForm.addEventListener('submit', handleLogin);
            
            // Logout button
            logoutBtn.addEventListener('click', handleLogout);
            
            // Initialize form if logged in
            if (isAdminLoggedIn) {
                initializeAdminPanel();
            }
        });
        
        // Check if user is already logged in
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('adminLoggedIn') === 'true';
            const loginTime = localStorage.getItem('adminLoginTime');
            
            // Check if session expired (24 hours)
            if (isLoggedIn && loginTime) {
                const currentTime = new Date().getTime();
                const loginTimestamp = parseInt(loginTime);
                const hoursSinceLogin = (currentTime - loginTimestamp) / (1000 * 60 * 60);
                
                if (hoursSinceLogin < 24) {
                    // Session is still valid
                    isAdminLoggedIn = true;
                    showAdminPanel();
                } else {
                    // Session expired
                    localStorage.removeItem('adminLoggedIn');
                    localStorage.removeItem('adminLoginTime');
                    isAdminLoggedIn = false;
                    showLoginForm();
                }
            } else {
                isAdminLoggedIn = false;
                showLoginForm();
            }
        }
        
        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            
            const password = adminPassword.value.trim();
            
            if (!password) {
                showLoginError('পাসওয়ার্ড দিন');
                return;
            }
            
            loginBtn.disabled = true;
            loginBtn.textContent = 'লগইন হচ্ছে...';
            loginError.textContent = '';
            
            // Check password (in production, this should be done on server side)
            if (password === ADMIN_PASSWORD) {
                // Successful login
                isAdminLoggedIn = true;
                localStorage.setItem('adminLoggedIn', 'true');
                localStorage.setItem('adminLoginTime', new Date().getTime().toString());
                
                // Create admin user with custom claims
                createAdminUser();
                
                // Hide login form and show admin panel
                setTimeout(() => {
                    showAdminPanel();
                    initializeAdminPanel();
                    loginBtn.disabled = false;
                    loginBtn.textContent = 'লগইন করুন';
                    adminPassword.value = '';
                }, 1000);
                
            } else {
                // Wrong password
                showLoginError('ভুল পাসওয়ার্ড');
                loginBtn.disabled = false;
                loginBtn.textContent = 'লগইন করুন';
            }
        }
        
        // Create admin user with custom token (for Firebase Rules)
        function createAdminUser() {
            // Sign in anonymously
            auth.signInAnonymously()
                .then((userCredential) => {
                    console.log("Admin user signed in anonymously");
                    // In production, you would generate a custom token on your server
                    // with admin claim and then sign in with that token
                })
                .catch((error) => {
                    console.error("Error signing in anonymously:", error);
                });
        }
        
        // Handle logout
        function handleLogout() {
            if (confirm('আপনি কি লগ আউট করতে চান?')) {
                auth.signOut()
                    .then(() => {
                        localStorage.removeItem('adminLoggedIn');
                        localStorage.removeItem('adminLoginTime');
                        isAdminLoggedIn = false;
                        showLoginForm();
                    })
                    .catch((error) => {
                        console.error("Error signing out:", error);
                    });
            }
        }
        
        // Show login form
        function showLoginForm() {
            loginOverlay.style.display = 'flex';
            adminHeader.style.display = 'none';
            adminContainer.style.display = 'none';
            isAdminLoggedIn = false;
        }
        
        // Show admin panel
        function showAdminPanel() {
            loginOverlay.style.display = 'none';
            adminHeader.style.display = 'block';
            adminContainer.style.display = 'flex';
            isAdminLoggedIn = true;
        }
        
        // Show login error
        function showLoginError(message) {
            loginError.textContent = message;
            adminPassword.focus();
            
            // Clear error after 3 seconds
            setTimeout(() => {
                loginError.textContent = '';
            }, 3000);
        }
        
        // Initialize admin panel (after login)
        function initializeAdminPanel() {
            initializeIconSelection();
            initializeFeatures();
            loadPlatformsFromFirebase();
            
            // Form submission
            platformForm.addEventListener('submit', handleFormSubmit);
            
            // Reset form
            resetBtn.addEventListener('click', resetForm);
            
            // Cancel edit
            cancelEditBtn.addEventListener('click', cancelEdit);
            
            // Add feature button
            addFeatureBtn.addEventListener('click', addFeatureInput);
            
            // Icon select change
            platformIcon.addEventListener('change', function() {
                selectedIcon = this.value;
                updateIconSelection();
            });
        }
        
        // Initialize icon selection grid
        function initializeIconSelection() {
            iconSelection.innerHTML = '';
            
            availableIcons.forEach(icon => {
                const iconOption = document.createElement('div');
                iconOption.className = 'icon-option';
                iconOption.setAttribute('data-value', icon.value);
                iconOption.innerHTML = `
                    <i class="${icon.class}"></i>
                    <span class="icon-option-name">${icon.name}</span>
                `;
                
                iconOption.addEventListener('click', function() {
                    selectIcon(icon.value);
                    platformIcon.value = icon.value;
                });
                
                iconSelection.appendChild(iconOption);
            });
        }
        
        // Select an icon
        function selectIcon(iconValue) {
            selectedIcon = iconValue;
            
            // Update icon options
            document.querySelectorAll('.icon-option').forEach(option => {
                if (option.getAttribute('data-value') === iconValue) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
        }
        
        // Update icon selection based on dropdown
        function updateIconSelection() {
            document.querySelectorAll('.icon-option').forEach(option => {
                if (option.getAttribute('data-value') === selectedIcon) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
        }
        
        // Initialize features input
        function initializeFeatures() {
            featuresContainer.innerHTML = '';
            // Add one initial feature input
            addFeatureInput();
        }
        
        // Add a new feature input
        function addFeatureInput() {
            const featureId = Date.now();
            const featureInputGroup = document.createElement('div');
            featureInputGroup.className = 'feature-input-group';
            featureInputGroup.innerHTML = `
                <input type="text" class="form-input feature-input" placeholder="ফিচার লিখুন..." data-id="${featureId}">
                <button type="button" class="remove-feature-btn" data-id="${featureId}">মুছুন</button>
            `;
            
            featuresContainer.appendChild(featureInputGroup);
            
            // Add event listener to remove button
            featureInputGroup.querySelector('.remove-feature-btn').addEventListener('click', function() {
                // Only remove if there's more than one feature input
                if (featuresContainer.children.length > 1) {
                    featureInputGroup.remove();
                } else {
                    // If it's the last one, just clear the input
                    featureInputGroup.querySelector('.feature-input').value = '';
                }
            });
        }
        
        // Get all features from inputs
        function getFeatures() {
            const features = [];
            const featureInputs = featuresContainer.querySelectorAll('.feature-input');
            
            featureInputs.forEach(input => {
                if (input.value.trim() !== '') {
                    features.push(input.value.trim());
                }
            });
            
            return features;
        }
        
        // Set features in the form
        function setFeatures(featuresArray) {
            // Clear existing features
            featuresContainer.innerHTML = '';
            
            if (featuresArray && featuresArray.length > 0) {
                featuresArray.forEach(feature => {
                    const featureId = Date.now();
                    const featureInputGroup = document.createElement('div');
                    featureInputGroup.className = 'feature-input-group';
                    featureInputGroup.innerHTML = `
                        <input type="text" class="form-input feature-input" value="${feature}" data-id="${featureId}">
                        <button type="button" class="remove-feature-btn" data-id="${featureId}">মুছুন</button>
                    `;
                    
                    featuresContainer.appendChild(featureInputGroup);
                    
                    // Add event listener to remove button
                    featureInputGroup.querySelector('.remove-feature-btn').addEventListener('click', function() {
                        if (featuresContainer.children.length > 1) {
                            featureInputGroup.remove();
                        } else {
                            featureInputGroup.querySelector('.feature-input').value = '';
                        }
                    });
                });
            } else {
                // Add one empty feature input
                addFeatureInput();
            }
        }
        
        // Load platforms from Firebase
        function loadPlatformsFromFirebase() {
            const platformsRef = database.ref('publicData/pricingPlans');
            
            platformsRef.on('value', (snapshot) => {
                const platformsData = snapshot.val();
                platforms = [];
                
                if (!platformsData) {
                    platformsList.innerHTML = '<div class="empty-state"><i class="fas fa-box-open"></i><p>কোন প্ল্যাটফর্ম পাওয়া যায়নি</p></div>';
                    return;
                }
                
                // Convert object to array
                Object.entries(platformsData).forEach(([id, platform]) => {
                    platforms.push({
                        id: id,
                        name: platform.name || '',
                        icon: platform.icon || 'default',
                        description: platform.description || '',
                        price: platform.price || '',
                        features: platform.features || [],
                        category: platform.category || '',
                        order: platform.order || 0,
                        status: platform.status || 'active'
                    });
                });
                
                // Sort by order
                platforms.sort((a, b) => (a.order || 0) - (b.order || 0));
                
                displayPlatforms();
            }, (error) => {
                console.error("Error loading platforms:", error);
                platformsList.innerHTML = '<div class="empty-state"><i class="fas fa-exclamation-triangle"></i><p>প্ল্যাটফর্ম লোড করতে সমস্যা হয়েছে</p></div>';
            });
        }
        
        // Display platforms in the list
        function displayPlatforms() {
            if (platforms.length === 0) {
                platformsList.innerHTML = '<div class="empty-state"><i class="fas fa-box-open"></i><p>কোন প্ল্যাটফর্ম পাওয়া যায়নি</p></div>';
                return;
            }
            
            platformsList.innerHTML = '';
            
            platforms.forEach(platform => {
                const platformItem = document.createElement('div');
                platformItem.className = 'platform-item';
                platformItem.setAttribute('data-id', platform.id);
                
                // Get icon class
                const iconInfo = availableIcons.find(icon => icon.value === platform.icon) || availableIcons.find(icon => icon.value === 'default');
                const iconClass = iconInfo ? iconInfo.class : 'fas fa-cube default';
                
                // Status badge
                const statusText = platform.status === 'active' ? 'সক্রিয়' : 'নিষ্ক্রিয়';
                const statusClass = platform.status === 'active' ? 'status-active' : 'status-inactive';
                
                // Features display
                let featuresHTML = '';
                if (platform.features && platform.features.length > 0) {
                    platform.features.forEach(feature => {
                        featuresHTML += `<span class="feature-tag"><i class="fas fa-check-circle"></i> ${feature}</span>`;
                    });
                }
                
                platformItem.innerHTML = `
                    <div class="platform-header">
                        <div class="platform-info">
                            <div class="platform-icon-display">
                                <i class="${iconClass}"></i>
                            </div>
                            <div class="platform-details">
                                <div class="platform-name-display">${platform.name}</div>
                                <div class="platform-price-display">${platform.price}</div>
                            </div>
                        </div>
                        <div class="platform-actions">
                            <button class="action-btn edit-btn" data-id="${platform.id}">এডিট</button>
                            <button class="action-btn delete-btn" data-id="${platform.id}">ডিলিট</button>
                        </div>
                    </div>
                    <div class="platform-description-display">${platform.description}</div>
                    ${featuresHTML ? `<div class="platform-features-display">${featuresHTML}</div>` : ''}
                    <div style="margin-top: 10px;">
                        <span class="status-badge ${statusClass}">${statusText}</span>
                        <span style="color: #b0bec5; font-size: 0.8rem; margin-left: 10px;">অর্ডার: ${platform.order || 0}</span>
                    </div>
                `;
                
                platformsList.appendChild(platformItem);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    editPlatform(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    deletePlatform(id);
                });
            });
        }
        
        // Handle form submission
        function handleFormSubmit(e) {
            e.preventDefault();
            
            if (!platformName.value.trim()) {
                alert('প্ল্যাটফর্মের নাম প্রয়োজন');
                platformName.focus();
                return;
            }
            
            if (!platformIcon.value) {
                alert('আইকন সিলেক্ট করুন');
                platformIcon.focus();
                return;
            }
            
            if (!platformDescription.value.trim()) {
                alert('বর্ণনা প্রয়োজন');
                platformDescription.focus();
                return;
            }
            
            if (!platformPrice.value.trim()) {
                alert('দাম প্রয়োজন');
                platformPrice.focus();
                return;
            }
            
            const platformData = {
                name: platformName.value.trim(),
                icon: platformIcon.value,
                description: platformDescription.value.trim(),
                price: platformPrice.value.trim(),
                features: getFeatures(),
                category: platformCategory.value.trim(),
                order: parseInt(platformOrder.value) || 0,
                status: platformStatus.value,
                updatedAt: firebase.database.ServerValue.TIMESTAMP
            };
            
            // If we're editing, add createdAt from existing platform
            if (!isEditing) {
                platformData.createdAt = firebase.database.ServerValue.TIMESTAMP;
            }
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'সেভ হচ্ছে...';
            
            if (isEditing && currentEditId) {
                // Update existing platform
                database.ref('publicData/pricingPlans/' + currentEditId).update(platformData)
                    .then(() => {
                        console.log('Platform updated successfully');
                        showSuccessMessage('প্ল্যাটফর্ম সফলভাবে আপডেট করা হয়েছে!');
                        resetForm();
                    })
                    .catch(error => {
                        console.error('Error updating platform:', error);
                        alert('প্ল্যাটফর্ম আপডেট করতে সমস্যা হয়েছে: ' + error.message);
                    })
                    .finally(() => {
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'সেভ করুন';
                    });
            } else {
                // Add new platform
                const newPlatformRef = database.ref('publicData/pricingPlans').push();
                newPlatformRef.set(platformData)
                    .then(() => {
                        console.log('Platform added successfully');
                        showSuccessMessage('নতুন প্ল্যাটফর্ম সফলভাবে যোগ করা হয়েছে!');
                        resetForm();
                    })
                    .catch(error => {
                        console.error('Error adding platform:', error);
                        alert('প্ল্যাটফর্ম যোগ করতে সমস্যা হয়েছে: ' + error.message);
                    })
                    .finally(() => {
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'সেভ করুন';
                    });
            }
        }
        
        // Edit a platform
        function editPlatform(id) {
            const platform = platforms.find(p => p.id === id);
            
            if (!platform) {
                alert('প্ল্যাটফর্ম পাওয়া যায়নি');
                return;
            }
            
            // Fill the form with platform data
            platformId.value = platform.id;
            platformName.value = platform.name || '';
            platformIcon.value = platform.icon || 'default';
            platformDescription.value = platform.description || '';
            platformPrice.value = platform.price || '';
            platformCategory.value = platform.category || '';
            platformOrder.value = platform.order || 0;
            platformStatus.value = platform.status || 'active';
            
            // Set features
            setFeatures(platform.features || []);
            
            // Set icon selection
            selectedIcon = platform.icon || 'default';
            updateIconSelection();
            
            // Change form to edit mode
            isEditing = true;
            currentEditId = id;
            formTitle.textContent = 'প্ল্যাটফর্ম এডিট করুন';
            submitBtn.textContent = 'আপডেট করুন';
            cancelEditBtn.style.display = 'block';
            
            // Scroll to form
            document.querySelector('.admin-form-section').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Delete a platform
        function deletePlatform(id) {
            if (!confirm('আপনি কি নিশ্চিত যে আপনি এই প্ল্যাটফর্মটি ডিলিট করতে চান?')) {
                return;
            }
            
            database.ref('publicData/pricingPlans/' + id).remove()
                .then(() => {
                    console.log('Platform deleted successfully');
                    showSuccessMessage('প্ল্যাটফর্ম সফলভাবে ডিলিট করা হয়েছে!');
                })
                .catch(error => {
                    console.error('Error deleting platform:', error);
                    alert('প্ল্যাটফর্ম ডিলিট করতে সমস্যা হয়েছে: ' + error.message);
                });
        }
        
        // Reset form
        function resetForm() {
            platformForm.reset();
            platformId.value = '';
            platformOrder.value = 0;
            platformStatus.value = 'active';
            selectedIcon = '';
            
            // Clear icon selection
            document.querySelectorAll('.icon-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Reset features
            initializeFeatures();
            
            // Reset form mode
            isEditing = false;
            currentEditId = null;
            formTitle.textContent = 'নতুন প্ল্যাটফর্ম যোগ করুন';
            submitBtn.textContent = 'সেভ করুন';
            cancelEditBtn.style.display = 'none';
        }
        
        // Cancel edit
        function cancelEdit() {
            resetForm();
        }
        
        // Show success message
        function showSuccessMessage(message) {
            // Create a temporary success message
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(45deg, #4caf50, #2e7d32);
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 10000;
                font-weight: 600;
                animation: slideIn 0.3s ease;
            `;
            
            successDiv.textContent = message;
            document.body.appendChild(successDiv);
            
            // Remove after 3 seconds
            setTimeout(() => {
                successDiv.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(successDiv);
                }, 300);
            }, 3000);
            
            // Add CSS for animations
            if (!document.getElementById('success-animations')) {
                const style = document.createElement('style');
                style.id = 'success-animations';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        }
    </script>
</body>
</html>
