<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Premium - Pay Now</title>
    <meta name="description" content="‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü - ‡ßß‡ß¶‡ß¶% ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞">
   
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
   
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
   
    <style>
        :root {
            --primary: #0a0a1a;
            --accent: #ff9800;
            --card: rgba(20,20,40,0.9);
            --border: rgba(255,152,0,0.3);
            --text: #ffffff;
            --success: #4caf50;
            --error: #ff5252;
            --info: #ffd54f;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            background: linear-gradient(135deg, #0a0a1a, #121230, #1a1a3a);
            color: var(--text);
            font-family: 'Segoe UI', sans-serif;
            min-height: 100vh;
            padding-top: 80px;
        }
        header {
            position: fixed;
            top: 0; left: 0; right: 0;
            background: rgba(10,10,26,0.95);
            backdrop-filter: blur(10px);
            padding: 15px;
            text-align: center;
            z-index: 1000;
        }
        .logo { font-size: 2.2rem; font-weight: bold; color: var(--accent); }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        .box {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 30px;
        }
        h1 { color: var(--accent); font-size: 2.2rem; margin-bottom: 20px; }
        .desc { font-size: 1.1rem; line-height: 1.8; white-space: pre-wrap; word-break: break-word; margin-bottom: 25px; }
        .price { font-size: 2.8rem; color: var(--success); text-align: center; font-weight: bold; margin: 25px 0; }
        .order-info {
            background: rgba(255,215,0,0.15);
            border: 1px solid #ffd54f;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.15rem;
        }
        .btn-pay {
            display: block;
            max-width: 400px;
            margin: 30px auto;
            padding: 18px;
            background: linear-gradient(45deg, var(--accent), #f57c00);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-pay:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(255,152,0,0.4); }
        .msg {
            text-align: center;
            font-size: 1.2rem;
            margin: 60px 0;
            padding: 20px;
            border-radius: 12px;
        }
        .error { background: rgba(255,82,82,0.15); color: #ff5252; }
        .info { background: rgba(255,215,0,0.15); color: #ffd54f; }
        footer { text-align: center; padding: 40px 20px; color: #b0bec5; font-size: 0.95rem; }
    </style>
</head>
<body>
    <header><div class="logo">Easy Premium</div></header>
    <div class="container">
        <div class="box">
            <div id="loading" class="msg info">‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
            <div id="errorMsg" class="msg error" style="display:none;"></div>
            <div id="orderSection" class="order-info" style="display:none;">
                ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø: <strong id="orderIdShow"></strong>
            </div>
            <h1 id="planName" style="display:none;"></h1>
            <div id="planDesc" class="desc" style="display:none;"></div>
            <div id="planPrice" class="price" style="display:none;"></div>
            <button id="payBtn" class="btn-pay" style="display:none;" onclick="handlePay()">
                Pay Now - Bkash / Nagad / Rocket
            </button>
        </div>
    </div>
    <footer>¬© ‡ß®‡ß¶‡ß®‡ß¨ Easy Premium | ‡¶∏‡¶ï‡¶≤ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ | ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü: +8801770584994</footer>
    
    <script>
        // Firebase config (‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ exact URL)
        firebase.initializeApp({
            databaseURL: "https://easy-premium-default-rtdb.asia-southeast1.firebasedatabase.app"
        });
        const db = firebase.database();
        
        // URL params (‡¶∂‡ßÅ‡¶ß‡ßÅ ?orderId= handle ‡¶ï‡¶∞‡¶¨‡ßá)
        const params = new URLSearchParams(window.location.search);
        const orderId = params.get('orderId');
        
        console.log('üîç Order ID from URL:', orderId); // Debug: F12 Console ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßã
        
        if (!orderId) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('errorMsg').style.display = 'block';
            document.getElementById('errorMsg').textContent = '‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞‡•§ URL-‡¶è ?orderId=-Ol4b3H8aB_NDCcMLyux ‡¶¶‡¶ø‡¶®‡•§';
            console.error('‚ùå No orderId in URL');
        } else {
            // Order ID show ‡¶ï‡¶∞‡ßã
            document.getElementById('orderIdShow').textContent = orderId;
            document.getElementById('orderSection').style.display = 'block';
            
            console.log('üì¶ Fetching order:', `userOrders/.../${orderId}`);
            
            // Step 1: Order data ‡¶≤‡ßã‡¶° (‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ structure: userOrders/uid/orderId)
            // ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡¶∂‡¶ü‡ßá userOrders > uid > orderId path, ‡¶§‡¶æ‡¶á multiple path try ‡¶ï‡¶∞‡¶õ‡¶ø
            Promise.any([
                db.ref(`userOrders/${orderId}`).once('value'),  // direct userOrders/orderId
                db.ref(`orders/${orderId}`).once('value'),      // orders/orderId  
                db.ref(`userOrders/‡¶ï‡ßã‡¶®‡ßãUID/${orderId}`).once('value') // fallback
            ])
            .then(async (snapshot) => {
                const orderData = snapshot.val();
                console.log('‚úÖ Order data:', orderData);
                
                if (!orderData) {
                    showError('‡¶è‡¶á ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ID ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ Firebase Rules ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßã‡•§');
                    return;
                }
                
                // Plan ID extract (multiple possible fields)
                const planId = orderData.planId || orderData.plan || orderData.pricingPlan || orderData.plan;
                console.log('üéØ Plan ID:', planId);
                
                if (!planId) {
                    showError('‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡ßá planId ‡¶®‡ßá‡¶á‡•§ Order data ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßã‡•§');
                    return;
                }
                
                // Step 2: Pricing plan + D description ‡¶≤‡ßã‡¶°
                console.log('üìã Fetching pricingPlans:', `pricingPlans/${planId}`);
                const planSnapshot = await db.ref(`pricingPlans/${planId}`).once('value');
                const planData = planSnapshot.val();
                
                console.log('üéâ FULL PLAN DATA (D ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø ‡¶®‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßã):', planData);
                
                document.getElementById('loading').style.display = 'none';
                
                if (planData) {
                    // Plan name
                    document.getElementById('planName').textContent = planData.name || '‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶®';
                    document.getElementById('planName').style.display = 'block';
                    
                    // D description (‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ main issue) - multiple fallback
                    const fullDesc = planData.D ||           // ‚Üê ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ Firebase-‡¶è D ‡¶Ü‡¶õ‡ßá
                                   planData.description || 
                                   planData.desc || 
                                   planData.Details || 
                                   '‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ Rules Publish ‡¶ï‡¶∞‡ßã‡•§';
                    console.log('üìÑ D/Description:', fullDesc.substring(0, 100) + '...');
                    
                    document.getElementById('planDesc').textContent = fullDesc;
                    document.getElementById('planDesc').style.display = 'block';
                    
                    // Price (‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ order ‡¶•‡ßá‡¶ï‡ßá ‡ß≥1900)
                    const price = planData.price || orderData.price || '---';
                    document.getElementById('planPrice').textContent = `‡ß≥${price}`;
                    document.getElementById('planPrice').style.display = 'block';
                    
                    document.getElementById('payBtn').style.display = 'block';
                    console.log('‚úÖ ‡¶∏‡¶¨ ‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! D ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶â‡¶ö‡¶ø‡¶§‡•§');
                } else {
                    showError(`‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶® "${planId}" ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ Console ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßã‡•§`);
                }
            })
            .catch(err => {
                console.error('‚ùå Firebase Error:', err);
                showError(`‡¶≤‡ßã‡¶°‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ: ${err.message || 'Permission Denied (Rules .read: true ‡¶ï‡¶∞‡ßã)'}`);
            });
        }
        
        function showError(message) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('errorMsg').style.display = 'block';
            document.getElementById('errorMsg').textContent = message;
        }
        
        function handlePay() {
            alert(`‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ö‡ßç‡¶õ‡ßá (‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞: ${orderId})\n‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó: 01770584994\nBkash/Nagad/Rocket`);
        }
    </script>
</body>
</html>
