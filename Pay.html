<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Premium - ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ü‡ßá‡¶á‡¶≤‡¶∏</title>
    
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            background: linear-gradient(135deg, #0a0a1a, #121230, #1a1a3a);
            color: white;
            font-family: Arial, sans-serif;
            min-height: 100vh;
        }
        .header {
            background: rgba(10,10,26,0.95);
            padding: 20px;
            text-align: center;
            border-bottom: 2px solid #ff9800;
        }
        .logo {
            color: #ff9800;
            font-size: 28px;
            font-weight: bold;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s;
        }
        .logo:hover {
            transform: scale(1.05);
            text-shadow: 0 0 10px rgba(255, 152, 0, 0.5);
        }
        .container {
            max-width: 900px;
            margin: 30px auto;
            padding: 20px;
        }
        /* ‡¶≤‡¶ó‡¶ø‡¶® ‡¶∏‡ßá‡¶ï‡¶∂‡¶® - ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü */
        .login-box {
            background: rgba(20,20,40,0.9);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid rgba(255,152,0,0.5);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none; /* ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã */
        }
        .login-input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255,255,255,0.1);
            border: 2px solid #ff9800;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }
        .login-input:focus {
            outline: none;
            border-color: #ff5722;
            box-shadow: 0 0 15px rgba(255, 152, 0, 0.3);
        }
        .login-btn {
            background: linear-gradient(45deg, #ff9800, #ff5722);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
            transition: all 0.3s;
        }
        .login-btn:hover {
            background: linear-gradient(45deg, #ff5722, #ff9800);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.4);
        }
        .order-box {
            background: rgba(20,20,40,0.95);
            border-radius: 15px;
            padding: 30px;
            border: 2px solid rgba(255,152,0,0.4);
            box-shadow: 0 15px 35px rgba(0,0,0,0.5);
        }
        .order-id {
            color: #ff9800;
            font-size: 24px;
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,152,0,0.3);
        }
        .platform-name {
            color: #4caf50;
            font-size: 22px;
            text-align: center;
            margin-bottom: 25px;
        }
        .details-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 25px 0;
        }
        .detail-item {
            background: rgba(0,0,0,0.3);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s;
        }
        .detail-item:hover {
            background: rgba(0,0,0,0.4);
            border-color: rgba(255,152,0,0.3);
            transform: translateY(-3px);
        }
        .detail-label {
            color: #b0bec5;
            font-size: 14px;
            margin-bottom: 8px;
        }
        .detail-value {
            color: white;
            font-size: 18px;
            font-weight: bold;
            word-break: break-all;
        }
        .description-box {
            background: rgba(0,0,0,0.3);
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            border-left: 4px solid #ff9800;
            max-height: 400px;
            overflow-y: auto;
            line-height: 1.6;
        }
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        .btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: 600;
        }
        .btn-confirm {
            background: linear-gradient(45deg, #4caf50, #2e7d32);
            color: white;
        }
        .btn-confirm:hover {
            background: linear-gradient(45deg, #2e7d32, #4caf50);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }
        .btn-cancel {
            background: linear-gradient(45deg, #ff5252, #d32f2f);
            color: white;
        }
        .btn-cancel:hover {
            background: linear-gradient(45deg, #d32f2f, #ff5252);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 82, 82, 0.3);
        }
        .btn-download {
            background: linear-gradient(45deg, #2196f3, #1976d2);
            color: white;
        }
        .btn-download:hover {
            background: linear-gradient(45deg, #1976d2, #2196f3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
        }
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #ff9800;
            background: rgba(20,20,40,0.9);
            border-radius: 15px;
            border: 2px solid rgba(255,152,0,0.3);
        }
        .error {
            background: rgba(255,82,82,0.15);
            color: #ff5252;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            border: 1px solid #ff5252;
        }
        footer {
            text-align: center;
            padding: 30px;
            color: #b0bec5;
            margin-top: 40px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        .secure-badge {
            background: linear-gradient(45deg, #4caf50, #2e7d32);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            display: inline-block;
            margin-left: 10px;
            vertical-align: middle;
        }
        .info-box {
            background: rgba(0,188,212,0.15);
            border-left: 4px solid #00bcd4;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            color: #b0bec5;
            font-size: 14px;
        }
        @media (max-width: 768px) {
            .details-grid { grid-template-columns: 1fr; }
            .action-buttons { flex-direction: column; }
            .container { padding: 15px; }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
    <div class="header">
        <a href="https://easy-premium.com" class="logo">
            <i class="fas fa-crown"></i> Easy Premium
        </a>
        <span class="secure-badge">
            <i class="fas fa-lock"></i> ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶≠‡¶ø‡¶â
        </span>
    </div>

    <div class="container">
        <!-- ‡¶≤‡¶ó‡¶ø‡¶® ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ -->
        <div class="login-box" id="loginSection">
            <h2 style="color: #ff9800; margin-bottom: 30px;">‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ü‡ßá‡¶á‡¶≤‡¶∏ ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏</h2>
            <input type="text" id="userId" class="login-input" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø">
            <input type="text" id="orderId" class="login-input" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø">
            <button class="login-btn" onclick="manualLogin()">
                <i class="fas fa-lock"></i> ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡ßÅ‡¶®
            </button>
            <div class="info-box">
                <i class="fas fa-info-circle"></i> ‡¶è‡¶á ‡¶™‡ßá‡¶ú‡ßá ‡¶≤‡¶ø‡¶Ç‡¶ï‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶Ü‡¶∏‡¶≤‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶ü‡¶ø‡¶ï ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá‡•§ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞/‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶¶‡¶ø‡ßü‡ßá ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶á‡¶≤‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ ‡¶´‡¶∞‡ßç‡¶Æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
            </div>
        </div>

        <!-- ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç -->
        <div class="loading" id="loadingSection">
            <i class="fas fa-spinner fa-spin fa-3x"></i>
            <p style="margin-top: 20px;">‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
        </div>

        <!-- ‡¶è‡¶∞‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú -->
        <div class="error" id="errorSection" style="display:none;"></div>

        <!-- ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ü‡ßá‡¶á‡¶≤‡¶∏ -->
        <div class="order-box" id="orderSection" style="display:none;">
            <div class="order-id" id="orderIdDisplay"></div>
            <div class="platform-name" id="platformNameDisplay"></div>
            
            <div class="details-grid">
                <div class="detail-item">
                    <div class="detail-label">‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø</div>
                    <div class="detail-value" id="detailOrderId"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ</div>
                    <div class="detail-value" id="detailPlatform"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</div>
                    <div class="detail-value" id="detailStatus"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø</div>
                    <div class="detail-value" id="detailPrice"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</div>
                    <div class="detail-value" id="detailDate"></div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø</div>
                    <div class="detail-value" id="detailUserId"></div>
                </div>
            </div>

            <!-- ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® -->
            <h3 style="color: #ff9800; margin-bottom: 15px;">
                <i class="fas fa-file-alt"></i> ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶®
            </h3>
            <div class="description-box" id="platformDescription"></div>

            <!-- ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ -->
            <h3 style="color: #ff9800; margin-top: 30px; margin-bottom: 15px;">
                <i class="fas fa-user-circle"></i> ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø
            </h3>
            <div class="description-box" id="userInfo">
                ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...
            </div>

            <!-- ‡¶ï‡ßç‡¶∞‡ßá‡¶°‡ßá‡¶®‡¶∂‡¶ø‡ßü‡¶æ‡¶≤‡¶∏ (‡¶Ø‡¶¶‡¶ø ‡¶•‡¶æ‡¶ï‡ßá) -->
            <div id="credentialsSection" style="display:none; margin-top: 25px;">
                <h3 style="color: #4caf50; margin-bottom: 15px;">
                    <i class="fas fa-key"></i> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡ßç‡¶∏‡ßá‡¶∏ ‡¶ï‡ßç‡¶∞‡ßá‡¶°‡ßá‡¶®‡¶∂‡¶ø‡ßü‡¶æ‡¶≤‡¶∏
                </h3>
                <div class="description-box" id="credentialsContent"></div>
            </div>

            <!-- ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®‡¶∏ -->
            <h3 style="color: #ff9800; margin-top: 30px; margin-bottom: 15px;">
                <i class="fas fa-tools"></i> ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®‡¶∏
            </h3>
            <div class="action-buttons">
                <button class="btn btn-confirm" onclick="confirmOrder()">
                    <i class="fas fa-check-circle"></i> ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ
                </button>
                <button class="btn btn-download" onclick="downloadDetails()">
                    <i class="fas fa-download"></i> ‡¶°‡¶ø‡¶ü‡ßá‡¶á‡¶≤‡¶∏ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
                </button>
                <button class="btn btn-cancel" onclick="cancelOrder()">
                    <i class="fas fa-times-circle"></i> ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡ßá‡¶≤
                </button>
            </div>
        </div>
    </div>

    <footer>
        ¬© ‡ß®‡ß¶‡ß®‡ß¨ Easy Premium | ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø | ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü: +8801770584994
    </footer>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

    <script>
        // ==================== SAME SECURE LINK GENERATOR ====================
        class SecureLinkGenerator {
            constructor() {
                this.encryptionKey = 'EP_SECURE_2025_KEY_!@#';
            }
            
            encryptData(data) {
                try {
                    const dataStr = JSON.stringify(data);
                    let encrypted = '';
                    for (let i = 0; i < dataStr.length; i++) {
                        const keyChar = this.encryptionKey.charCodeAt(i % this.encryptionKey.length);
                        const dataChar = dataStr.charCodeAt(i);
                        encrypted += String.fromCharCode(dataChar ^ keyChar);
                    }
                    return btoa(encrypted);
                } catch (error) {
                    console.error("Encryption error:", error);
                    return null;
                }
            }
            
            decryptData(encryptedData) {
                try {
                    const decoded = atob(encryptedData);
                    let decrypted = '';
                    for (let i = 0; i < decoded.length; i++) {
                        const keyChar = this.encryptionKey.charCodeAt(i % this.encryptionKey.length);
                        const dataChar = decoded.charCodeAt(i);
                        decrypted += String.fromCharCode(dataChar ^ keyChar);
                    }
                    return JSON.parse(decrypted);
                } catch (error) {
                    console.error("Decryption error:", error);
                    return null;
                }
            }
            
            parsePaymentLink(url) {
                try {
                    const urlObj = new URL(url);
                    const encryptedData = urlObj.searchParams.get('data');
                    if (!encryptedData) return null;
                    return this.decryptData(encryptedData);
                } catch (error) {
                    console.error("Error parsing payment link:", error);
                    return null;
                }
            }
        }

        // Firebase Configuration
        const firebaseConfig = {
            databaseURL: "https://easy-premium-default-rtdb.asia-southeast1.firebasedatabase.app"
        };

        // Firebase Initialize
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const secureLinkGenerator = new SecureLinkGenerator();

        let currentUserId = '';
        let currentOrderId = '';

        // DOM ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡ßü‡¶æ‡¶∞ ‡¶™‡¶∞‡¶á ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶¨‡ßá
        document.addEventListener('DOMContentLoaded', function() {
            console.log("üìå ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡ßü‡ßá‡¶õ‡ßá...");
            checkURLForData();
        });

        // URL ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
        function checkURLForData() {
            const urlParams = new URLSearchParams(window.location.search);
            const encryptedData = urlParams.get('data');
            
            if (encryptedData) {
                console.log("üîê ‡¶è‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü‡ßá‡¶° ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶ó‡ßá‡¶õ‡ßá:", encryptedData.substring(0, 30) + "...");
                processEncryptedData(encryptedData);
            } else {
                // URL-‡¶è ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ü‡¶á‡¶°‡¶ø ‡¶•‡¶æ‡¶ï‡¶≤‡ßá
                const orderId = urlParams.get('orderId');
                const userId = urlParams.get('userId');
                const platformId = urlParams.get('platformId');
                
                if (orderId && userId) {
                    console.log("üìä ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ü‡¶á‡¶°‡¶ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶ó‡ßá‡¶õ‡ßá");
                    loadOrderData(userId, orderId);
                } else {
                    // ‡¶ï‡ßã‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶ó‡ßá‡¶≤‡ßá ‡¶≤‡¶ó‡¶ø‡¶® ‡¶´‡¶∞‡ßç‡¶Æ ‡¶∂‡ßã ‡¶ï‡¶∞‡ßÅ‡¶®
                    console.log("‚ö†Ô∏è ‡¶ï‡ßã‡¶® ‡¶è‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü‡ßá‡¶° ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á, ‡¶≤‡¶ó‡¶ø‡¶® ‡¶´‡¶∞‡ßç‡¶Æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá");
                    showLoginForm();
                }
            }
        }

        // ‡¶è‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü‡ßá‡¶° ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡ßÅ‡¶®
        function processEncryptedData(encryptedData) {
            document.getElementById('loadingSection').style.display = 'block';
            document.getElementById('loginSection').style.display = 'none';
            
            try {
                const decryptedData = secureLinkGenerator.decryptData(encryptedData);
                console.log("‚úÖ ‡¶°‡¶ø‡¶ï‡ßã‡¶°‡ßá‡¶° ‡¶°‡¶æ‡¶ü‡¶æ:", decryptedData);
                
                if (decryptedData && decryptedData.u && decryptedData.o) {
                    const { u: userId, o: orderId, p: platformId } = decryptedData;
                    console.log(`üìã ‡¶Ü‡¶á‡¶°‡¶ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶ó‡ßá‡¶õ‡ßá - ‡¶á‡¶â‡¶ú‡¶æ‡¶∞: ${userId}, ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞: ${orderId}`);
                    loadOrderData(userId, orderId);
                } else {
                    throw new Error("‡¶°‡¶ø‡¶ï‡ßã‡¶°‡ßá‡¶° ‡¶°‡¶æ‡¶ü‡¶æ‡¶§‡ßá ‡¶Ø‡¶•‡ßá‡¶∑‡ßç‡¶ü ‡¶§‡¶•‡ßç‡¶Ø ‡¶®‡ßá‡¶á");
                }
            } catch (error) {
                console.error("‚ùå ‡¶°‡¶ø‡¶ï‡ßã‡¶°‡¶ø‡¶Ç ‡¶è‡¶∞‡¶∞:", error);
                showError("‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤‡¶ø ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
                showLoginForm();
            }
        }

        // Firebase ‡¶•‡ßá‡¶ï‡ßá ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®
        async function loadOrderData(userId, orderId) {
            currentUserId = userId;
            currentOrderId = orderId;
            
            console.log(`üîç ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá: ‡¶á‡¶â‡¶ú‡¶æ‡¶∞=${userId}, ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞=${orderId}`);
            
            try {
                // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
                const userOrdersRef = db.ref(`userOrders/${userId}/${orderId}`);
                const snapshot = await userOrdersRef.once('value');

                if (!snapshot.exists()) {
                    throw new Error('‡¶è‡¶á ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø');
                }

                const orderData = snapshot.val();
                console.log('‚úÖ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ:', orderData);

                // ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶™‡ßá‡¶§‡ßá
                const platformId = orderData.platformId || orderData.platform;
                if (!platformId) {
                    throw new Error('‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡ßá ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶®‡ßá‡¶á');
                }

                // ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®
                const platformRef = db.ref(`publicData/pricingPlans/${platformId}`);
                const platformSnap = await platformRef.once('value');

                if (!platformSnap.exists()) {
                    throw new Error('‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶°‡ßá‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø');
                }

                const platformData = platformSnap.val();

                // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®
                let userData = null;
                try {
                    const userRef = db.ref(`users/${userId}`);
                    const userSnap = await userRef.once('value');
                    if (userSnap.exists()) {
                        userData = userSnap.val();
                    }
                } catch (userError) {
                    console.log("‚ö†Ô∏è ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®‡¶ø:", userError);
                }

                // ‡¶∏‡¶¨ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∂‡ßã ‡¶ï‡¶∞‡ßÅ‡¶®
                displayOrderData(userId, orderId, orderData, platformData, userData);

            } catch (error) {
                console.error('‚ùå Error:', error);
                showError(error.message);
                showLoginForm();
            }
        }

        function displayOrderData(userId, orderId, orderData, platformData, userData) {
            // UI ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            document.getElementById('loadingSection').style.display = 'none';
            document.getElementById('orderSection').style.display = 'block';
            document.getElementById('loginSection').style.display = 'none';

            // 1. ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø
            document.getElementById('orderIdDisplay').textContent = `‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ #${orderId}`;
            document.getElementById('detailOrderId').textContent = orderId;

            // 2. ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶®‡¶æ‡¶Æ
            const platformName = orderData.platform || platformData.name || 'Unknown';
            document.getElementById('platformNameDisplay').textContent = platformName;
            document.getElementById('detailPlatform').textContent = platformName;

            // 3. ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏
            const status = orderData.status || 'pending';
            const statusElement = document.getElementById('detailStatus');
            statusElement.textContent = status;
            
            // ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞
            if (status === 'success' || status === 'completed' || status === 'confirmed') {
                statusElement.style.color = '#4caf50';
            } else if (status === 'pending' || status === 'processing') {
                statusElement.style.color = '#ff9800';
            } else if (status === 'cancelled' || status === 'failed') {
                statusElement.style.color = '#ff5252';
            }

            // 4. ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø
            const price = orderData.price || platformData.price || 'N/A';
            document.getElementById('detailPrice').textContent = `‡ß≥ ${price}`;

            // 5. ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ
            const orderDate = orderData.orderDate || orderData.date || new Date().toISOString();
            document.getElementById('detailDate').textContent = formatDate(orderDate);

            // 6. ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø
            document.getElementById('detailUserId').textContent = userId;

            // 7. ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶®
            let description = '';
            if (platformData.D) {
                description = platformData.D;
            } else if (platformData.description) {
                description = platformData.description;
            } else if (platformData.desc) {
                description = platformData.desc;
            } else {
                description = '‡¶ï‡ßã‡¶®‡ßã ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® ‡¶®‡ßá‡¶á';
            }
            document.getElementById('platformDescription').textContent = description;

            // 8. ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶á‡¶®‡¶´‡ßã
            let userInfoHtml = '';
            if (userData) {
                userInfoHtml += `üë§ ‡¶®‡¶æ‡¶Æ: ${userData.displayName || '‡¶®‡ßá‡¶á'}<br>`;
                userInfoHtml += `üìß ‡¶á‡¶Æ‡ßá‡¶á‡¶≤: ${userData.email || '‡¶®‡ßá‡¶á'}<br>`;
                userInfoHtml += `üìÖ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø: ${formatDate(userData.createdAt || '')}<br>`;
                userInfoHtml += `üîê ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ü‡¶æ‡¶á‡¶™: ${userData.accountType || 'customer'}`;
            } else {
                userInfoHtml = '‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø';
            }
            document.getElementById('userInfo').innerHTML = userInfoHtml;

            // 9. ‡¶ï‡ßç‡¶∞‡ßá‡¶°‡ßá‡¶®‡¶∂‡¶ø‡ßü‡¶æ‡¶≤‡¶∏ (‡¶Ø‡¶¶‡¶ø ‡¶•‡¶æ‡¶ï‡ßá)
            if (orderData.credentials || orderData.username || orderData.password) {
                let credentials = '';
                if (orderData.credentials) {
                    credentials = orderData.credentials;
                } else {
                    credentials = `üë§ Username: ${orderData.username || 'N/A'}\n`;
                    credentials += `üîí Password: ${orderData.password || 'N/A'}`;
                }
                document.getElementById('credentialsContent').textContent = credentials;
                document.getElementById('credentialsSection').style.display = 'block';
            }

            // 10. ‡¶™‡ßá‡¶ú ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤
            document.title = `${platformName} - ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ #${orderId} - Easy Premium`;
            
            console.log("‚úÖ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá");
        }

        // ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤ ‡¶≤‡¶ó‡¶ø‡¶® ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        function manualLogin() {
            const userId = document.getElementById('userId').value.trim();
            const orderId = document.getElementById('orderId').value.trim();

            if (!userId || !orderId) {
                showError('‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá');
                return;
            }

            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('loadingSection').style.display = 'block';
            
            loadOrderData(userId, orderId);
        }

        // ‡¶≤‡¶ó‡¶ø‡¶® ‡¶´‡¶∞‡ßç‡¶Æ ‡¶∂‡ßã
        function showLoginForm() {
            document.getElementById('loadingSection').style.display = 'none';
            document.getElementById('errorSection').style.display = 'none';
            document.getElementById('orderSection').style.display = 'none';
            document.getElementById('loginSection').style.display = 'block';
            
            // URL-‡¶è ‡¶Ø‡¶¶‡¶ø ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶•‡¶æ‡¶ï‡ßá, ‡¶Ö‡¶ü‡ßã‡¶´‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®
            const urlParams = new URLSearchParams(window.location.search);
            const orderIdFromUrl = urlParams.get('orderId');
            if (orderIdFromUrl) {
                document.getElementById('orderId').value = orderIdFromUrl;
            }
        }

        function confirmOrder() {
            if (confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡¶ü‡¶ø ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
                const updateRef = db.ref(`userOrders/${currentUserId}/${currentOrderId}/status`);
                updateRef.set('confirmed')
                    .then(() => {
                        alert('‚úÖ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
                        document.getElementById('detailStatus').textContent = 'confirmed';
                        document.getElementById('detailStatus').style.color = '#4caf50';
                    })
                    .catch(error => {
                        alert('‚ùå ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ: ' + error.message);
                    });
            }
        }

        function cancelOrder() {
            if (confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡¶ü‡¶ø ‡¶ï‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡ßá‡¶≤ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
                const updateRef = db.ref(`userOrders/${currentUserId}/${currentOrderId}/status`);
                updateRef.set('cancelled')
                    .then(() => {
                        alert('‚úÖ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡ßá‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
                        document.getElementById('detailStatus').textContent = 'cancelled';
                        document.getElementById('detailStatus').style.color = '#ff5252';
                    })
                    .catch(error => {
                        alert('‚ùå ‡¶ï‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡ßá‡¶≤ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ: ' + error.message);
                    });
            }
        }

        function downloadDetails() {
            const platformName = document.getElementById('detailPlatform').textContent;
            const status = document.getElementById('detailStatus').textContent;
            const price = document.getElementById('detailPrice').textContent;
            const date = document.getElementById('detailDate').textContent;
            const description = document.getElementById('platformDescription').textContent;

            const orderContent = `
=====================================
      EASY PREMIUM - ORDER DETAILS
=====================================

üì¶ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø: ${currentOrderId}
üë§ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø: ${currentUserId}
üõí ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ: ${platformName}
üìä ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏: ${status}
üí∞ ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ${price}
üìÖ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${date}

üìã ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶°‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶®:
${description}

‚ÑπÔ∏è ‡¶è‡¶á ‡¶´‡¶æ‡¶á‡¶≤‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§
üîê ‡¶ï‡ßá‡¶â ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§

¬© ‡ß®‡ß¶‡ß®‡ß¨ Easy Premium
üìû ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü: +8801770584994
üåê ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü: https://easy-premium.com
=====================================
            `;

            const blob = new Blob([orderContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `easy-premium-order-${currentOrderId}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('üì• ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ü‡ßá‡¶á‡¶≤‡¶∏ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
        }

        function formatDate(dateString) {
            try {
                const date = new Date(dateString);
                if (isNaN(date.getTime())) return dateString;
                
                return date.toLocaleDateString('bn-BD', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: true
                });
            } catch (e) {
                return dateString;
            }
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorSection');
            errorDiv.innerHTML = `
                <h3><i class="fas fa-exclamation-triangle"></i> ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá</h3>
                <p>${message}</p>
                <button onclick="showLoginForm()" style="
                    background: #ff9800;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    border-radius: 5px;
                    margin-top: 15px;
                    cursor: pointer;
                ">
                    <i class="fas fa-sign-in-alt"></i> ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶≤ ‡¶≤‡¶ó‡¶á‡¶®
                </button>
            `;
            errorDiv.style.display = 'block';
            document.getElementById('loadingSection').style.display = 'none';
        }
    </script>
</body>
</html>
